<!DOCTYPE html>
<html lang="es">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Actividades de Jóvenes</title>
    <style>
      body {
        font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto,
          "Helvetica Neue", Arial, sans-serif;
        margin: 0;
        background-color: #f4f4f4;
        color: #2c2c2c;
      }

      .container {
        max-width: 1000px;
        margin: 0 auto;
        background-color: white;
        padding: 20px;
        box-shadow: 0 2px 4px rgba(0, 0, 0, 0.1);
      }

      h1 {
        text-align: center;
        color: #0b3d91;
        font-weight: 600;
        margin-bottom: 30px;
      }

      table {
        width: 100%;
        border-collapse: collapse;
        margin-top: 20px;
        box-shadow: 0 1px 3px rgba(0, 0, 0, 0.1);
      }

      th,
      td {
        padding: 12px 16px;
        text-align: left;
        border-bottom: 1px solid #e5e5e5;
      }

      th {
        background-color: #0b3d91;
        color: white;
        font-weight: 500;
      }

      tr:hover {
        background-color: #f8f9fa;
      }

      button {
        display: block;
        margin: 20px auto;
        padding: 12px 24px;
        font-size: 16px;
        background-color: #0b3d91;
        color: white;
        border: none;
        border-radius: 3px;
        cursor: pointer;
        transition: background-color 0.2s;
      }

      button:hover {
        background-color: #082e6f;
      }

      .header {
        background-color: #0b3d91;
        color: white;
        padding: 15px 0;
        margin-bottom: 30px;
      }

      .header-content {
        max-width: 1000px;
        margin: 0 auto;
        padding: 0 20px;
      }

      .header h2 {
        margin: 0;
        font-weight: 400;
      }

      @media (max-width: 768px) {
        .container {
          margin: 0 10px;
          padding: 10px;
        }

        thead {
          display: none;
        }

        table,
        tbody,
        tr,
        td {
          display: block;
          width: 100%;
        }

        tr {
          margin-bottom: 12px;
          border: 1px solid #e5e5e5;
          border-radius: 12px;
          background: white;
          padding: 12px;
          box-shadow: 0 2px 8px rgba(0, 0, 0, 0.08);
        }

        td {
          padding: 2px 0;
          border: none;
          position: relative;
          text-align: left;
        }

        td[data-label="Actividad"] {
          display: flex;
          justify-content: space-between;
          align-items: center;
          font-size: 1.1rem;
          font-weight: 600;
          color: #0b3d91;
          padding-bottom: 8px;
          margin-bottom: 6px;
          border-bottom: 1px solid #e5e5e5;
        }

        .activity-name {
          margin-right: 8px;
          line-height: 1.2;
        }

        .group-type {
          font-size: 0.75rem;
          color: #666;
          background-color: #f0f0f0;
          padding: 3px 8px;
          border-radius: 12px;
          white-space: nowrap;
        }

        td[data-label="Fecha"],
        td[data-label="Hora"] {
          display: inline-block;
          padding-right: 8px;
          color: #666;
          font-size: 0.9rem;
          margin-bottom: 4px;
        }

        td[data-label="Ubicación"] {
          margin-top: 4px;
          color: #444;
          font-style: italic;
          font-size: 0.9rem;
        }

        td[data-label="Ubicación"]:empty {
          display: none;
        }

        td[data-label="Grupo"] {
          display: none;
        }
      }

      @media (max-width: 480px) {
        tr {
          margin-bottom: 10px;
          padding: 10px;
        }

        td[data-label="Actividad"] {
          font-size: 1rem;
          padding-bottom: 6px;
          margin-bottom: 4px;
        }

        .group-type {
          font-size: 0.7rem;
          padding: 2px 6px;
        }
      }

      .announcements {
        margin: 30px 0;
        padding: 20px;
        background-color: #f8f9fa;
        border-radius: 5px;
        border-left: 4px solid #0b3d91;
      }

      .announcements h2 {
        color: #0b3d91;
        margin-top: 0;
        font-size: 1.5em;
        margin-bottom: 20px;
      }

      .announcement-box {
        background-color: white;
        padding: 15px;
        border-radius: 3px;
        box-shadow: 0 1px 3px rgba(0, 0, 0, 0.1);
      }

      #announcementList {
        list-style: none;
        padding: 0;
        margin: 0;
      }

      #announcementList li {
        padding: 15px;
        border-bottom: 1px solid #e5e5e5;
        transition: background-color 0.2s;
      }

      #announcementList li:hover {
        background-color: #f8f9fa;
      }

      .announcement-header {
        display: flex;
        justify-content: space-between;
        margin-bottom: 5px;
      }

      .announcement-date,
      .announcement-location {
        color: #666;
        font-size: 0.9em;
        font-weight: 500;
      }

      .announcement-location {
        color: #0b3d91;
      }

      .announcement-text {
        font-size: 1.1em;
        font-weight: 500;
        color: #2c2c2c;
        margin: 5px 0;
      }

      .announcement-details {
        color: #666;
        font-size: 0.9em;
        margin: 5px 0 0 0;
      }

      .image-container {
        margin: 0 auto 20px;
        text-align: center;
      }

      .main-image {
        max-width: 200px;
        height: auto;
        border-radius: 5px;
        box-shadow: 0 2px 4px rgba(0, 0, 0, 0.1);
      }

      @media (min-width: 769px) {
        table {
          width: 100%;
          border-collapse: separate;
          border-spacing: 0;
          margin-top: 20px;
          box-shadow: 0 1px 3px rgba(0, 0, 0, 0.1);
          background: white;
          border-radius: 8px;
          overflow: hidden;
        }

        th,
        td {
          padding: 16px 20px;
          text-align: left;
          border-bottom: 1px solid #edf2f7;
        }

        th {
          background-color: #0b3d91;
          color: white;
          font-weight: 500;
          font-size: 0.95rem;
          letter-spacing: 0.5px;
        }

        td {
          font-size: 0.95rem;
          line-height: 1.4;
          color: #2d3748;
        }

        td:first-child {
          font-weight: 600;
          color: #0b3d91;
        }

        th:nth-child(1),
        td:nth-child(1) {
          width: 30%;
        }
        th:nth-child(2),
        td:nth-child(2) {
          width: 15%;
        }
        th:nth-child(3),
        td:nth-child(3) {
          width: 15%;
        }
        th:nth-child(4),
        td:nth-child(4) {
          width: 25%;
        }
        th:nth-child(5),
        td:nth-child(5) {
          width: 15%;
        }

        .group-type {
          display: none;
        }

        .activity-name {
          display: inline;
        }

        tr:hover td {
          background-color: #f8fafc;
          transition: background-color 0.2s ease;
        }

        tr:nth-child(even) td {
          background-color: #fafbff;
        }

        tr:last-child td {
          border-bottom: none;
        }

        th:first-child {
          border-top-left-radius: 8px;
        }

        th:last-child {
          border-top-right-radius: 8px;
        }

        tr:last-child td:first-child {
          border-bottom-left-radius: 8px;
        }

        tr:last-child td:last-child {
          border-bottom-right-radius: 8px;
        }
      }
    </style>
  </head>
  <body>
    <div class="header">
      <div class="header-content">
        <h2>Actividades de Mutual- Rogers 2 Jovenes</h2>
      </div>
    </div>
    <div class="container">
      <div class="image-container">
        <img src="./Temple.webp" alt="Jóvenes" class="main-image" />
      </div>

      <div class="announcements">
        <h2>Anuncios</h2>
        <div class="announcement-box">
          <ul id="announcementList"></ul>
        </div>
      </div>

      <h1>Actividades de Mutual</h1>

      <button onclick="toggleGroup()" id="toggleButton">
        Cambiar a Mujeres Jóvenes
      </button>
      <table id="activitiesTable">
        <thead>
          <tr>
            <th>Grupo</th>
            <th>Fecha</th>
            <th>Actividad</th>
            <th>Hora</th>
            <th>Ubicación</th>
          </tr>
        </thead>
        <tbody></tbody>
      </table>
    </div>

    <script type="module">
      const hombresJovenes = [];
      const mujeresJovenes = [];

      function loadGoogleSheetsAPI() {
        const script = document.createElement("script");
        script.src = "https://apis.google.com/js/api.js";
        script.onload = () => {
          gapi.load("client", initClient);
        };
        document.body.appendChild(script);
      }

      function initClient() {
        gapi.client
          .init({
            apiKey: import.meta.env.VITE_GOOGLE_SHEETS_API_KEY,
            discoveryDocs: [
              "https://sheets.googleapis.com/$discovery/rest?version=v4",
            ],
          })
          .then(() => {
            loadSheetData();
          });
      }

      function loadSheetData() {
        const spreadsheetId = "11UFIghe-HyEh7GeVQ4a7qlLJTF3PI_BOqwqc2og9ZVg";

        const hombresPromise = gapi.client.sheets.spreadsheets.values.get({
          spreadsheetId: spreadsheetId,
          range: "Actividades!A:E",
        });

        const mujeresPromise = gapi.client.sheets.spreadsheets.values.get({
          spreadsheetId: spreadsheetId,
          range: "Actividades!G:K",
        });

        const anunciosPromise = gapi.client.sheets.spreadsheets.values.get({
          spreadsheetId: spreadsheetId,
          range: "Actividades!M:P",
        });

        Promise.all([hombresPromise, mujeresPromise, anunciosPromise])
          .then(([hombresResponse, mujeresResponse, anunciosResponse]) => {
            const hombresRows = hombresResponse.result.values;
            const mujeresRows = mujeresResponse.result.values;
            const anunciosRows = anunciosResponse.result.values;

            if (hombresRows && hombresRows.length > 1) {
              for (let i = 1; i < hombresRows.length; i++) {
                const row = hombresRows[i];
                if (row && row[0]) {
                  hombresJovenes.push(row);
                }
              }
            }

            if (mujeresRows && mujeresRows.length > 1) {
              for (let i = 1; i < mujeresRows.length; i++) {
                const row = mujeresRows[i];
                if (row && row[0]) {
                  mujeresJovenes.push(row);
                }
              }
            }

            if (anunciosRows && anunciosRows.length > 1) {
              const announcementList =
                document.getElementById("announcementList");
              announcementList.innerHTML = "";

              for (let i = 1; i < anunciosRows.length; i++) {
                const row = anunciosRows[i];
                if (row && row[0]) {
                  const li = document.createElement("li");
                  li.innerHTML = `
                                <div class="announcement-header">
                                    <span class="announcement-date">${
                                      row[1] || ""
                                    }</span>
                                    <span class="announcement-location">${
                                      row[2] || ""
                                    }</span>
                                </div>
                                <p class="announcement-text">${row[0] || ""}</p>
                                <p class="announcement-details"> ${
                                  row[3] || ""
                                }</p>
                            `;
                  announcementList.appendChild(li);
                }
              }
            } else {
              document.getElementById("announcementList").innerHTML =
                "<li>No hay anuncios disponibles en este momento.</li>";
            }

            displayActivities(hombresJovenes);
          })
          .catch((error) => {
            document.querySelector("#activitiesTable tbody").innerHTML =
              '<tr><td colspan="5">Error cargando las actividades. Por favor intente más tarde.</td></tr>';
            document.getElementById("announcementList").innerHTML =
              "<li>Error cargando los anuncios. Por favor intente más tarde.</li>";
          });
      }

      window.onload = loadGoogleSheetsAPI;

      let currentGroup = "hombres";

      function displayActivities(activities) {
        const tbody = document.querySelector("#activitiesTable tbody");
        tbody.innerHTML = "";

        const tableHeaders = document.querySelectorAll("#activitiesTable th");
        const headerOrder = [
          "Actividad",
          "Fecha",
          "Hora",
          "Ubicación",
          "Grupo",
        ];
        tableHeaders.forEach((th, index) => {
          th.textContent = headerOrder[index];
        });

        activities.forEach((activity) => {
          const row = document.createElement("tr");

          const order = [2, 1, 3, 4, 0];

          order.forEach((index, i) => {
            const td = document.createElement("td");
            td.setAttribute("data-label", headerOrder[i]);

            if (i === 0) {
              const groupType = activity[0].includes("Hombres")
                ? "Hombres Jovenes"
                : "Mujeres Jovenes";
              td.innerHTML = `
                        <span class="activity-name">${activity[2] || ""}</span>
                        <span class="group-type">${groupType}</span>
                    `;
            } else if (i === 3) {
              td.textContent = activity[4] || "";
            } else if (i === 4) {
              td.textContent = activity[0] || "";
            } else {
              td.textContent = activity[index] || "";
            }

            row.appendChild(td);
          });
          tbody.appendChild(row);
        });
      }

      function toggleGroup() {
        const button = document.getElementById("toggleButton");

        if (currentGroup === "hombres") {
          displayActivities(mujeresJovenes);
          currentGroup = "mujeres";
          button.textContent = "Cambiar a Hombres Jóvenes";
        } else {
          displayActivities(hombresJovenes);
          currentGroup = "hombres";
          button.textContent = "Cambiar a Mujeres Jóvenes";
        }
      }
    </script>
  </body>
</html>
